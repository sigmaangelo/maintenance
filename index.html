<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cloaked Access</title>
<style>
  body { background:white; font-family:Arial; text-align:center; margin-top:100px; }
</style>
</head>

<body>

<h1>Press to Cloak</h1>
<button onclick="cloak()">CLOAK</button>

<script>
const PASSWORD = "1234";

function cloak() {
    let win = window.open("about:blank", "_blank");

    win.document.write(`
      <h2>Enter Password</h2>
      <input id="pass" type="password" />
      <button onclick="login()">Enter</button>
      <p id='msg'></p>

      <script>
      async function login() {
        const p = document.getElementById('pass').value;

        if (p !== "${PASSWORD}") {
            document.getElementById('msg').innerText = "Wrong password";
            return;
        }

        const fd = new FormData();
        fd.append("password", "${PASSWORD}");

        const res = await fetch("/login", { method:"POST", body:fd });

        if (!res.ok) {
            document.getElementById('msg').innerText = "Server rejected";
            return;
        }

        // Cloaked navigation
        window.location.href = "/games.html";

      }
      <\/script>
    `);
    win.document.close();
}
</script>

</body>
</html>
