<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cloak</title>
<style>
  body {
    background:#fff;
    color:#000;
    text-align:center;
    padding-top:100px;
    font-family:Arial;
  }
  button {
    font-size:22px;
    padding:15px 30px;
    cursor:pointer;
  }
</style>
</head>

<body>
<h1>CLOAKED ACCESS</h1>
<button onclick="cloak()">ENTER</button>

<script>
function cloak() {
  const win = window.open("about:blank", "_blank");

  win.document.open();
  win.document.write(`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>Login</title>
      <style>
        body {
          background:#fff;
          color:#000;
          text-align:center;
          padding-top:100px;
          font-family:Arial;
        }
        input,button {
          padding:10px;
          margin:8px;
          font-size:18px;
        }
      </style>
    </head>

    <body>
      <h1>Enter Password</h1>
      <input id="pw" type="password" placeholder="Password">
      <br>
      <button onclick="login()">Submit</button>
      <p id="msg"></p>

      <script>
      async function login() {
        const pw = document.getElementById("pw").value;

        const res = await fetch("/login", {
          method: "POST",
          headers: { "Content-Type":"application/json" },
          body: JSON.stringify({ password: pw })
        });

        if (!res.ok) {
          document.getElementById("msg").textContent = "Wrong password";
          return;
        }

        // Correct password â†’ navigate to games.html inside cloak tab
        location.href = "/games.html";
      }

      document.getElementById("pw").addEventListener("keydown", e => {
        if (e.key === "Enter") login();
      });
      <\/script>
    </body>
    </html>
  `);

  win.document.close();
}
</script>

</body>
</html>
